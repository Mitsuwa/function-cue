#!/bin/bash

set -e -x -o pipefail

echo $(pwd)

declare -a PROVIDERS=( "provider-aws@v0.44.2" "provider-azure@v0.20.0" "provider-gcp@v0.22.0" )

for p in "${PROVIDERS[@]}"; do
    go get "github.com/crossplane-contrib/${p}"

    find "${GOPATH}/pkg/mod/github.com/crossplane-contrib/${p}/apis" -name "*.go" | xargs -I {} dirname {} | uniq | xargs -I {} cue get go {} || true
done

mv cue.mod out
